<!-- Personality Quiz Modal -->
    <div class="modal fade" id="personalityQuizModal" tabindex="-1" aria-labelledby="quizModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content" style="background: var(--card-bg); border: 1px solid rgba(138, 43, 226, 0.3); border-radius: 20px;">
                <div class="modal-header" style="border-bottom: 1px solid rgba(138, 43, 226, 0.2);">
                    <h3 class="modal-title" id="quizModalLabel" style="background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        <i class="fas fa-brain me-2"></i>Discover Your Personality
                    </h3>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <div class="modal-body p-4">
                    <div id="quizContent">
                        <div class="progress mb-4" style="height: 8px; background: rgba(138, 43, 226, 0.1);">
                            <div class="progress-bar" id="quizProgress" role="progressbar" style="background: var(--gradient-primary); width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div id="quizQuestion" class="mb-4">
                            <h4 class="mb-3" style="color: var(--text-light);" id="questionText">Loading question...</h4>
                            <div id="quizOptions" class="d-grid gap-3"></div>
                        </div>
                    </div>
                    <div id="quizResult" style="display: none; text-align: center;">
                        <div class="personality-icon mb-3" style="font-size: 5rem; color: #20B2AA;">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <h3 class="mb-3" id="resultType" style="background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent;"></h3>
                        <p class="mb-4" id="resultDescription" style="color: var(--text-muted); font-size: 1.1rem;"></p>
                        <div class="compatibility-score mb-4">
                            <span style="color: var(--text-muted);">Your Compatibility Score</span>
                            <h2 id="resultScore" style="background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 3rem; font-weight: 700;"></h2>
                        </div>
                        <button class="btn btn-resonance" onclick="location.reload()">Retake Quiz</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Preview Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="background: var(--card-bg); border: 1px solid rgba(138, 43, 226, 0.3); border-radius: 20px; overflow: hidden;">
                <div class="modal-header" style="background: var(--gradient-mind); border: none; padding: 0; height: 200px; position: relative;">
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 100%;">
                        <i class="fas fa-brain" style="font-size: 4rem; color: rgba(255,255,255,0.9); margin-bottom: 10px;"></i>
                        <div id="profileCompatibility" style="color: white; font-size: 1.5rem; font-weight: 600;"></div>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1); position: absolute; top: 15px; right: 15px; z-index: 10;"></button>
                </div>
                <div class="modal-body p-4">
                    <h3 id="profileName" class="mb-2" style="color: var(--text-light);"></h3>
                    <p id="profileType" class="mb-3" style="color: #20B2AA; font-weight: 600;"></p>
                    <div class="mb-3">
                        <h5 style="color: var(--text-light); margin-bottom: 15px;"><i class="fas fa-music me-2" style="color: var(--primary-pink);"></i>Music Taste</h5>
                        <p id="profileMusic" style="color: var(--text-muted);"></p>
                    </div>
                    <div class="mb-3">
                        <h5 style="color: var(--text-light); margin-bottom: 15px;"><i class="fas fa-heart me-2" style="color: var(--primary-pink);"></i>About</h5>
                        <p id="profileBio" style="color: var(--text-muted);"></p>
                    </div>
                    <div class="d-flex gap-3">
                        <button class="btn btn-outline-resonance flex-fill"><i class="fas fa-times me-2"></i>Pass</button>
                        <button class="btn btn-resonance flex-fill"><i class="fas fa-heart me-2"></i>Connect</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Music Player Widget -->
    <div id="musicPlayer" class="music-player-widget" style="display: none;">
        <div class="player-content">
            <button class="player-close" onclick="closeMusicPlayer()"><i class="fas fa-times"></i></button>
            <div class="player-info">
                <i class="fas fa-music player-icon"></i>
                <div>
                    <div class="player-genre" id="playerGenre">Ghazals</div>
                    <div class="player-track" id="playerTrack">Sample Track Playing</div>
                </div>
            </div>
            <div class="player-controls">
                <button class="player-btn" onclick="togglePlay()">
                    <i class="fas fa-pause" id="playPauseIcon"></i>
                </button>
            </div>
            <div class="player-progress">
                <div class="progress" style="height: 4px; background: rgba(138, 43, 226, 0.2);">
                    <div class="progress-bar" id="playerProgressBar" style="background: var(--gradient-primary); width: 0%;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Match Notification -->
    <div id="matchNotification" class="match-notification" style="display: none;">
        <div class="notification-content">
            <div class="notification-icon">
                <i class="fas fa-heart"></i>
            </div>
            <div class="notification-text">
                <strong>New Match!</strong>
                <p>You have a 94% compatibility with Sarah</p>
            </div>
            <button class="notification-close" onclick="closeNotification()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <style>
        /* Music Player Widget Styles */
        .music-player-widget {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 999;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(138, 43, 226, 0.3);
            min-width: 320px;
            animation: slideInLeft 0.5s ease;
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .player-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.3s;
        }

        .player-close:hover {
            color: var(--primary-pink);
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .player-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .player-genre {
            font-weight: 600;
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .player-track {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .player-controls {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }

        .player-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            border: none;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .player-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(138, 43, 226, 0.3);
        }

        .player-progress {
            margin-top: 10px;
        }

        /* Match Notification Styles */
        .match-notification {
            position: fixed;
            top: 100px;
            right: 30px;
            z-index: 999;
            animation: slideInRight 0.5s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-content {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(138, 43, 226, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
            min-width: 320px;
        }

        .notification-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            animation: heartbeat 1s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .notification-text strong {
            color: var(--text-light);
            display: block;
            margin-bottom: 5px;
        }

        .notification-text p {
            color: var(--text-muted);
            margin: 0;
            font-size: 0.9rem;
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1.2rem;
            margin-left: auto;
            transition: color 0.3s;
        }

        .notification-close:hover {
            color: var(--primary-pink);
        }

        /* Quiz Option Buttons */
        .quiz-option {
            background: var(--card-bg);
            border: 2px solid rgba(138, 43, 226, 0.2);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-light);
            text-align: left;
        }

        .quiz-option:hover {
            border-color: var(--primary-purple);
            background: rgba(138, 43, 226, 0.05);
            transform: translateX(5px);
        }

        .quiz-option.selected {
            border-color: var(--primary-purple);
            background: rgba(138, 43, 226, 0.1);
        }

        /* Counter Animation */
        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-number {
            animation: countUp 0.5s ease;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .music-player-widget,
            .match-notification {
                left: 15px;
                right: 15px;
                min-width: auto;
            }

            .match-notification {
                top: 80px;
            }
        }
    </style>

    <!-- Interactive Script -->
    <script>
        // ===== PERSONALITY QUIZ DATA =====
        const quizData = [
            {
                question: "How do you recharge after a long day?",
                options: [
                    { text: "Spending time alone with my thoughts or hobbies", type: "Introvert" },
                    { text: "Meeting friends and socializing", type: "Extrovert" },
                    { text: "Listening to music in solitude", type: "Introvert" },
                    { text: "Attending social events or parties", type: "Extrovert" }
                ]
            },
            {
                question: "When making decisions, you rely more on:",
                options: [
                    { text: "Logic and objective analysis", type: "Thinking" },
                    { text: "Personal values and empathy", type: "Feeling" },
                    { text: "What feels right emotionally", type: "Feeling" },
                    { text: "Rational pros and cons", type: "Thinking" }
                ]
            },
            {
                question: "Your ideal weekend involves:",
                options: [
                    { text: "Spontaneous adventures and new experiences", type: "Perceiving" },
                    { text: "Well-planned activities with clear schedules", type: "Judging" },
                    { text: "Going with the flow, seeing what happens", type: "Perceiving" },
                    { text: "Structured activities I planned ahead", type: "Judging" }
                ]
            },
            {
                question: "When learning something new, you prefer:",
                options: [
                    { text: "Understanding the big picture and possibilities", type: "Intuitive" },
                    { text: "Focusing on facts and practical details", type: "Sensing" },
                    { text: "Exploring theoretical concepts", type: "Intuitive" },
                    { text: "Hands-on, step-by-step learning", type: "Sensing" }
                ]
            },
            {
                question: "What type of music speaks to your soul?",
                options: [
                    { text: "Deep, emotional music like ghazals or classical", type: "Classical" },
                    { text: "Indie and alternative with unique sounds", type: "Indie" },
                    { text: "World music and fusion genres", type: "World" },
                    { text: "Upbeat, popular contemporary music", type: "Pop" }
                ]
            }
        ];

        let currentQuestion = 0;
        let quizAnswers = { Introvert: 0, Extrovert: 0, Thinking: 0, Feeling: 0, Judging: 0, Perceiving: 0, Intuitive: 0, Sensing: 0, Classical: 0, Indie: 0, World: 0, Pop: 0 };

        // ===== UTILITY FUNCTIONS =====
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // ===== QUIZ FUNCTIONS =====
        function showQuestion() {
            const question = quizData[currentQuestion];
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('quizProgress').style.width = ((currentQuestion / quizData.length) * 100) + '%';
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionBtn = document.createElement('button');
                optionBtn.className = 'quiz-option';
                optionBtn.textContent = option.text;
                optionBtn.onclick = () => selectAnswer(option.type, optionBtn);
                optionsContainer.appendChild(optionBtn);
            });
        }

        function selectAnswer(type, button) {
            quizAnswers[type]++;
            
            // Visual feedback
            button.classList.add('selected');
            setTimeout(() => {
                currentQuestion++;
                if (currentQuestion < quizData.length) {
                    showQuestion();
                } else {
                    showQuizResult();
                }
            }, 500);
        }

        function showQuizResult() {
            const personalityTypes = {
                Visionary: { icon: 'fa-lightbulb', description: 'Creative, idealistic, and deeply intuitive. You value authenticity and meaningful connections.' },
                Analyst: { icon: 'fa-cogs', description: 'Logical, curious, and intellectually driven. You seek partners who engage in deep discussions.' },
                Guardian: { icon: 'fa-hands-helping', description: 'Reliable, caring, and deeply committed. You value stability and loyalty in relationships.' },
                Explorer: { icon: 'fa-star', description: 'Energetic, spontaneous, and adventure-seeking. You love new experiences and living in the moment.' }
            };

            // Determine personality type based on answers
            const isIntrovert = quizAnswers.Introvert > quizAnswers.Extrovert;
            const isIntuitive = quizAnswers.Intuitive > quizAnswers.Sensing;
            const isFeeling = quizAnswers.Feeling > quizAnswers.Thinking;
            
            let resultType = 'Visionary';
            if (!isIntrovert && quizAnswers.Thinking > quizAnswers.Feeling) resultType = 'Analyst';
            else if (isIntrovert && quizAnswers.Judging > quizAnswers.Perceiving) resultType = 'Guardian';
            else if (!isIntrovert && quizAnswers.Perceiving > quizAnswers.Judging) resultType = 'Explorer';

            const score = Math.floor(75 + Math.random() * 20);

            document.getElementById('quizContent').style.display = 'none';
            document.getElementById('quizResult').style.display = 'block';
            document.getElementById('resultType').textContent = 'The ' + resultType;
            document.getElementById('resultDescription').textContent = personalityTypes[resultType].description;
            document.getElementById('resultScore').textContent = score + '%';
            
            // Change icon
            document.querySelector('#quizResult .personality-icon i').className = 'fas ' + personalityTypes[resultType].icon;
        }

        // ===== MUSIC PLAYER FUNCTIONS =====
        let isPlaying = false;
        let playerInterval;

        function openMusicPlayer(genre, track) {
            const player = document.getElementById('musicPlayer');
            document.getElementById('playerGenre').textContent = genre;
            document.getElementById('playerTrack').textContent = track;
            player.style.display = 'block';
            isPlaying = true;
            startProgress();
        }

        function closeMusicPlayer() {
            document.getElementById('musicPlayer').style.display = 'none';
            isPlaying = false;
            clearInterval(playerInterval);
        }

        function togglePlay() {
            isPlaying = !isPlaying;
            document.getElementById('playPauseIcon').className = isPlaying ? 'fas fa-pause' : 'fas fa-play';
            if (isPlaying) {
                startProgress();
            } else {
                clearInterval(playerInterval);
            }
        }

        function startProgress() {
            let progress = 0;
            clearInterval(playerInterval);
            playerInterval = setInterval(() => {
                if (isPlaying) {
                    progress += 1;
                    if (progress > 100) progress = 0;
                    document.getElementById('playerProgressBar').style.width = progress + '%';
                }
            }, 200);
        }

        // ===== PROFILE MODAL FUNCTIONS =====
        const profiles = [
            { name: 'Priya', type: 'INFP · The Dreamer', compatibility: '92%', music: 'Ghazals, Indie Folk, Classical', bio: 'Loves deep conversations, poetry, and meaningful connections.' },
            { name: 'Raj', type: 'INTJ · The Analyst', compatibility: '88%', music: 'Classical, Jazz, Instrumental', bio: 'Passionate about philosophy, science, and exploring complex ideas.' },
            { name: 'Sarah', type: 'ENFJ · The Guide', compatibility: '94%', music: 'Indie, Alternative Rock, Folk', bio: 'Empathetic leader who loves helping others grow and connecting deeply.' }
        ];

        function showProfile(index) {
            const profile = profiles[index];
            document.getElementById('profileName').textContent = profile.name;
            document.getElementById('profileType').textContent = profile.type;
            document.getElementById('profileCompatibility').textContent = profile.compatibility + ' Match';
            document.getElementById('profileMusic').textContent = profile.music;
            document.getElementById('profileBio').textContent = profile.bio;
            
            const modal = new bootstrap.Modal(document.getElementById('profileModal'));
            modal.show();
        }

        // ===== NOTIFICATION FUNCTIONS =====
        function showMatchNotification() {
            const notification = document.getElementById('matchNotification');
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.animation = 'slideInRight 0.5s ease';
            }, 100);
        }

        function closeNotification() {
            const notification = document.getElementById('matchNotification');
            notification.style.animation = 'slideOutRight 0.5s ease';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 500);
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        // ===== ANIMATED COUNTER =====
        function animateCounter(element, target) {
            let current = 0;
            const increment = target / 50;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    element.textContent = target.toLocaleString() + (element.dataset.suffix || '');
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current).toLocaleString() + (element.dataset.suffix || '');
                }
            }, 30);
        }

        // ===== MAIN INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
